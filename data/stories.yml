version: "2.0"

stories:
- story: new user wants to know about trippy
  steps:
  - intent: register
  - action: register_form
  - slot_was_set:
    - is_authenticated: true
  - action: action_register_user
  - intent: ask_for_company_info
  - action: action_query_company_info
  - intent: help
  - action: utter_help
  - intent: ask_for_popular_packages
  - action: action_query_popular_packages
  - intent: book_package
  - action: book_package_form
  - slot_was_set:
    - destination: Bangkok
  - action: action_create_user_order

- story: user said something dont the bot dont understand
  steps:
  - intent: nlu_fallback
  - action: utter_dont_understand
  - intent: nlu_fallback
  - action: utter_dont_understand
  - intent: ask_for_human_assistant
  - action: utter_request_human_assistant
  - intent: give_feedback
    entities:
    - feedback: "your customer service is really inefficient!"
  - action: utter_feedback_recorded
  - action: utter_thank

- story: user want to see booked orders
  steps:
  - intent: greet
  - action: utter_greet
  - intent: ask_user_orders
  - action: utter_login_or_register
  - intent: login
  - action: login_form
  - slot_was_set:
    - is_authenticated: true
  - action: action_login_user
  - intent: ask_user_orders
  - action: action_query_user_orders

- story: user register new account and see booked orders
  steps:
  - intent: greet
  - action: utter_greet
  - intent: ask_user_orders
  - action: utter_login_or_register
  - intent: register
  - action: register_form
  - slot_was_set:
    - is_authenticated: true
  - action: action_register_user
  - intent: ask_user_orders
  - action: action_query_user_orders

- story: User doesn't want to continue login
  steps:
  - intent: login
  - action: login_form
  - active_loop: login_form
  - intent: stop
  - action: utter_is_sure_to_stop
  - or: 
    - intent: stop
    - intent: affirm
  - action: action_deactivate_loop
  - active_loop: null
  - action: utter_ok

- story: User doesn't want to continue register
  steps:
  - intent: register
  - action: register_form
  - active_loop: register_form
  - intent: stop
  - action: utter_is_sure_to_stop
  - or: 
    - intent: stop
    - intent: affirm
  - action: action_deactivate_loop
  - active_loop: null
  - action: utter_ok

- story: user want to book a trip
  steps:
  - intent: greet
  - action: utter_greet
  - intent: book_package
  - action: utter_login_or_register
  - intent: login
  - action: login_form
  - slot_was_set:
    - is_authenticated: true
  - action: action_login_user
  - intent: book_package
  - action: book_package_form
  - slot_was_set:
    - destination: Madrid
  - action: action_create_user_order

- story: user want to book a trip2
  steps:
  - intent: greet
  - action: utter_greet
  - intent: ask_for_package_by_country
    entities:
    - country: Switzerland
  - action: action_query_country_specific_packages
  - intent: ask_for_shorter_duration
  - action: utter_short_can_be_arranged
  - intent: book_package
  - action: utter_login_or_register
  - intent: login
  - action: login_form
  - slot_was_set:
    - is_authenticated: true
  - action: action_login_user
  - intent: book_package
  - action: book_package_form
  - slot_was_set:
    - destination: Madrid
  - action: action_create_user_order

- story: user want to book a trip3
  steps:
  - intent: book_package
  - action: utter_login_or_register
  - intent: login
  - action: login_form
  - slot_was_set:
    - is_authenticated: true
  - intent: book_package
    entities:
    - destination: Kobe
  - action: book_package_form
  - slot_was_set:
    - destination: Kobe
  - action: action_create_user_order

- story: User doesn't want to continue booking
  steps:
  - intent: greet
  - action: utter_greet
  - intent: book_package
  - action: utter_login_or_register
  - intent: login
  - action: login_form
  - slot_was_set:
    - is_authenticated: true
  - action: action_login_user
  - intent: book_package
  - action: book_package_form
  - active_loop: book_package_form
  - intent: stop
  - action: utter_is_sure_to_stop
  - or: 
    - intent: stop
    - intent: affirm
  - action: action_deactivate_loop
  - active_loop: null
  - action: utter_ok

- story: user wants to view popular packages
  steps:
  - intent: greet
  - action: utter_greet
  - intent: ask_for_popular_packages
  - action: action_query_popular_packages
  - intent: thank
  - action: utter_you_are_welcome
  - intent: goodbye
  - action: utter_goodbye
  - action: utter_if_want_give_feedback
  - intent: deny
  - action: utter_ok

- story: user wants to view country specific packages
  steps:
  - intent: greet
  - action: utter_greet
  - intent: ask_for_package_by_country
    entities:
    - country: Japan
  - action: action_query_country_specific_packages

- story: user wants to view country specific package2
  steps:
  - intent: greet
  - action: utter_greet
  - intent: ask_for_package_by_country
    entities:
    - country: Japan
  - action: action_query_country_specific_packages
  - intent: book_package
    entities:
    - destination: Hokkaido
  - action: utter_login_or_register
  - intent: login
  - action: login_form
  - slot_was_set:
    - is_authenticated: true
  - action: action_login_user
  - intent: book_package
    entities:
    - destination: Hokkaido
  - action: book_package_form
  - slot_was_set:
    - destination: Hokkaido
  - action: action_create_user_order
  - intent: thank
  - action: utter_you_are_welcome
  - intent: goodbye
  - action: utter_if_want_give_feedback
  - or:
    - intent: affirm
    - intent: give_feedback
  - action: utter_feedback_recorded
  - action: utter_thank

- story: user wants to view country specific packages2
  steps:
  - intent: greet
  - action: utter_greet
  - intent: help
  - action: utter_help
  - intent: ask_for_package_by_country
    entities:
    - country: Japan
  - action: action_query_country_specific_packages

- story: user give feedback
  steps:
  - intent: greet
  - action: utter_greet
  - intent: give_feedback
    entities:
    - feedback: "you tend to forget what I just said."
  - action: utter_feedback_recorded
  - action: utter_thank

- story: user cancel trip
  steps:
  - intent: greet
  - action: utter_greet
  - intent: help
  - action: utter_help
  - intent: flight_delays_or_cancellation
  - action: utter_offer_next_available_or_cancel
  - intent: cancel_trip
  - action: utter_confirm_if_cancel
  - or:
    - intent: cancel_trip
    - intent: affirm
  - action: action_cancel_user_trip

- story: user change flight
  steps:
  - intent: greet
  - action: utter_greet
  - intent: help
  - action: utter_help
  - intent: flight_delays_or_cancellation
  - action: utter_offer_next_available_or_cancel
  - intent: get_next_available
  - action: action_get_next_available_flight
  - action: utter_ask_if_the_new_flight_is_suitable
  - intent: affirm
  - action: action_change_flight

- story: user want to change guide
  steps:
  - intent: greet
  - action: utter_greet
  - intent: help
  - action: utter_help
  - intent: guide_unavailable_or_delayed
  - action: utter_offer_change_guide
  - intent: affirm
  - action: action_change_guide

- story: user want to change guide
  steps:
  - intent: greet
  - action: utter_greet
  - intent: guide_unavailable_or_delayed
  - action: utter_offer_change_guide
  - intent: travel_alone
  - action: action_offer_coupon

- story: hotel not available1
  steps:
  - intent: greet
  - action: utter_greet
  - intent: hotel_unavailable
  - action: utter_ask_if_want_new_room
  - intent: affirm
  - action: action_find_new_room
  - action: utter_ask_if_the_new_room_is_suitable
  - intent: deny
  - action: action_find_new_room
  - action: utter_ask_if_the_new_room_is_suitable
  - intent: affirm
  - action: action_change_new_room


- story: hotel not available2
  steps:
  - intent: greet
  - action: utter_greet
  - intent: hotel_unavailable
  - action: utter_ask_if_want_new_room
  - or:
    - intent: deny
    - intent: customer_book_hotel
  - action: utter_offer_refound_for_hotel

- story: hotel not available3
  steps:
  - intent: greet
  - action: utter_greet
  - intent: hotel_unavailable
  - action: utter_ask_if_want_new_room
  - intent: affirm
  - action: action_find_new_room
  - action: utter_ask_if_the_new_room_is_suitable
  - intent: deny
  - action: action_find_new_room
  - action: utter_ask_if_the_new_room_is_suitable
  - or:
    - intent: customer_book_hotel
    - intent: stop
  - action: utter_offer_refound_for_hotel

- story: user ask for company and contact information
  steps:
  - intent: greet
  - action: utter_greet
  - intent: ask_for_company_info
  - action: action_query_company_info
  - intent: ask_for_company_contact
  - action: action_query_company_contact
  - intent: thank
  - action: utter_you_are_welcome
